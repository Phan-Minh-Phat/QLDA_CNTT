@page
@model DeTai4.Pages.Design_Staff.ManageDesignsModel
@{
    ViewData["Title"] = "Manage Designs";
}

<div class="container mt-4">
    <h2 class="text-center mb-4">Manage Designs</h2>

    <!-- Form tìm kiếm thiết kế theo tên -->
    <form method="get" class="mb-4">
        <div class="input-group">
            <!-- Sử dụng Request.Query["designName"] để lấy giá trị tìm kiếm từ query string -->
            <input type="text" class="form-control" id="designSearch" name="designName" placeholder="Search by Design Name" value="@Request.Query["designName"]" />
            <button class="btn btn-primary" type="submit">Search</button>
        </div>
    </form>

    <!-- Hiển thị danh sách thiết kế -->
    <table class="table table-bordered">
        <thead>
            <tr>
                <th>Design Name</th>
                <th>Description</th>
                <th>Cost</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var design in Model.Designs)
            {
                <tr>
                    <td>@design.DesignName</td>
                    <td>@design.Description</td>
                    <td>@design.Cost.ToString("C")</td>
                    <td>
                        <a href="@Url.Page("EditDesign", new { id = design.DesignId })" class="btn btn-warning">Edit</a>
                        <a href="#" onclick="deleteDesign(@design.DesignId)" class="btn btn-danger">Delete</a>
                    </td>
                </tr>
            }
        </tbody>
    </table>

    <div>
        @if (!string.IsNullOrEmpty(ViewData["ErrorMessage"]?.ToString()))
        {
            <div class="alert alert-danger">
                @ViewData["ErrorMessage"]
            </div>
        }
    </div>
</div>

@section Scripts {
    <script>
        function deleteDesign(designId) {
            if (confirm("Are you sure you want to delete this design?")) {
                $.ajax({
                    type: "POST",
                    url: "@Url.Page("DeleteDesign")",
                    data: { designId: designId },
                    success: function () {
                        location.reload();
                    },
                    error: function () {
                        alert("Error deleting the design");
                    }
                });
            }
        }
    </script>
}
